(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{5133:function(e,s,t){Promise.resolve().then(t.bind(t,3876))},3876:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return j}});var l=t(7437),r=t(946),a=t(9827),i=t(2265),n=t(5725),o=t(2954);function d(e){let{currentFolderId:s,onUploadComplete:t}=e,[r,a]=(0,i.useState)({}),[d,c]=(0,i.useState)(!1),u=(0,i.useCallback)(async e=>{c(!0);try{for(let t of e){let e=new FormData;e.append("file",t),s&&e.append("folderId",s),await o.h.client.post("/files/upload",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{e.total&&a(s=>({...s,[t.name]:Math.round(e.loaded/e.total*100)}))}})}null==t||t()}catch(e){console.error("Upload failed:",e)}finally{c(!1),setTimeout(()=>a({}),3e3)}},[s,t]),{getRootProps:m,getInputProps:x,isDragActive:h}=(0,n.uI)({onDrop:u});return(0,l.jsxs)("div",{...m(),className:"border-2 border-dashed rounded p-6 text-center ".concat(h?"bg-blue-50":"bg-white"," ").concat(d?"opacity-50":""),children:[(0,l.jsx)("input",{...x(),disabled:d}),(0,l.jsx)("p",{children:d?"Uploading...":"Drag & drop files here, or click to select"}),(0,l.jsx)("div",{className:"mt-4 space-y-2",children:Object.entries(r).map(e=>{let[s,t]=e;return(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:s}),(0,l.jsxs)("span",{children:[t,"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(t,"%")}})})]},s)})})]})}var c=t(1713),u=t(4210);function m(e){let{url:s,fileName:t}=e,[r,a]=(0,i.useState)(!0),[n,o]=(0,i.useState)(!1);return(0,l.jsxs)("div",{className:"w-full h-full",children:[r&&(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading PDF..."})]})}),n?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCC4"}),(0,l.jsx)("p",{className:"text-gray-600 mb-2",children:"PDF preview not available"}),(0,l.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"Open PDF in new tab"})]})}):(0,l.jsx)("iframe",{src:s,className:"w-full h-full border-0",title:t,onLoad:()=>a(!1),onError:()=>{a(!1),o(!0)}})]})}function x(e){let{url:s,fileName:t}=e,[r,a]=(0,i.useState)(""),[n,o]=(0,i.useState)(!0),[d,c]=(0,i.useState)(null);return((0,i.useEffect)(()=>{(async()=>{try{o(!0),c(null);let e=await fetch(s);if(!e.ok)throw Error("Failed to fetch file content");let t=await e.text();a(t)}catch(e){c(e instanceof Error?e.message:"Failed to load file")}finally{o(!1)}})()},[s]),n)?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading text file..."})]})}):d?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCDD"}),(0,l.jsx)("p",{className:"text-gray-600 mb-2",children:"Failed to load text file"}),(0,l.jsx)("p",{className:"text-sm text-red-600",children:d}),(0,l.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline mt-2 inline-block",children:"Open in new tab"})]})}):(0,l.jsxs)("div",{className:"w-full h-full",children:[(0,l.jsxs)("div",{className:"bg-gray-50 px-4 py-2 border-b flex items-center justify-between",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:t}),(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:[r.length," characters"]})]}),(0,l.jsx)("div",{className:"p-4 h-full overflow-auto",children:(0,l.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 font-mono leading-relaxed",children:r})})]})}function h(e){let s,{file:t,onClose:r}=e,[a,n]=(0,i.useState)(null),[d,c]=(0,i.useState)(!1),[u,h]=(0,i.useState)(null);(0,i.useEffect)(()=>{f()},[t.id]);let f=async()=>{if(a)return a;c(!0),h(null);try{console.log("Getting preview URL for file:",t.id);let{data:e}=await o.h.client.get("/files/".concat(t.id,"/preview"));return console.log("Preview URL received:",e.previewUrl),n(e.previewUrl),e.previewUrl}catch(t){var e,s,l;return h((null==t?void 0:null===(l=t.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:null===(e=s.error)||void 0===e?void 0:e.message)||(null==t?void 0:t.message)||"Failed to get preview URL"),console.error("Preview error:",t),null}finally{c(!1)}},p=async()=>{try{console.log("Getting download URL for file:",t.id);let{data:e}=await o.h.client.get("/files/".concat(t.id,"/download"));return console.log("Download URL received:",e.downloadUrl),e.downloadUrl}catch(e){return console.error("Download error:",e),"/api/files/".concat(t.id,"/stream")}},v=async()=>{let e=await p();if(e){let s=document.createElement("a");s.href=e,s.download=t.name,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},g=async()=>{let e=await p();e&&window.open(e,"_blank")},j=e=>{let s=parseInt(e);return s<1024?"".concat(s," B"):s<1048576?"".concat((s/1024).toFixed(1)," KB"):s<1073741824?"".concat((s/1048576).toFixed(1)," MB"):"".concat((s/1073741824).toFixed(1)," GB")},y=e=>e.startsWith("image/")?"\uD83D\uDDBC️":e.startsWith("video/")?"\uD83C\uDFA5":e.startsWith("audio/")?"\uD83C\uDFB5":e.includes("pdf")?"\uD83D\uDCC4":e.includes("text")||e.includes("word")||e.includes("document")?"\uD83D\uDCDD":e.includes("excel")||e.includes("spreadsheet")?"\uD83D\uDCCA":e.includes("powerpoint")||e.includes("presentation")?"\uD83D\uDCC8":e.includes("zip")||e.includes("archive")?"\uD83D\uDDDC️":"\uD83D\uDCC4";return(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("span",{className:"text-2xl",children:y(t.mimeType)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",title:t.name,children:t.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:[t.mimeType," • ",j(t.size)]})]})]}),(0,l.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsxs)("div",{className:"p-6",children:[u&&(0,l.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,l.jsx)("p",{className:"text-red-600 text-sm",children:u})}),(0,l.jsx)("div",{className:"mb-6",style:{minHeight:"400px"},children:t.mimeType.startsWith("image/")&&a?(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("img",{src:a,alt:t.name,className:"max-w-full max-h-96 mx-auto rounded-lg shadow-sm",onError:()=>h("Failed to load image preview")})}):t.mimeType.startsWith("video/")&&a?(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("video",{src:a,controls:!0,className:"max-w-full max-h-96 mx-auto rounded-lg shadow-sm",onError:()=>h("Failed to load video preview"),children:"Your browser does not support video playback."})}):t.mimeType.startsWith("audio/")&&a?(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("audio",{src:a,controls:!0,className:"w-full max-w-md mx-auto",onError:()=>h("Failed to load audio preview"),children:"Your browser does not support audio playback."})}):t.mimeType.includes("pdf")&&a?(0,l.jsx)("div",{className:"border rounded-lg overflow-hidden",style:{height:"500px"},children:(0,l.jsx)(m,{url:a,fileName:t.name})}):t.mimeType.includes("text")&&a?(0,l.jsx)("div",{className:"border rounded-lg overflow-hidden",style:{height:"500px"},children:(0,l.jsx)(x,{url:a,fileName:t.name})}):(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:y(t.mimeType)}),(0,l.jsx)("p",{className:"text-gray-600 mb-2",children:"Preview not available for this file type"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:[t.mimeType," • ",j(t.size)]})]})}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3 justify-center",children:[((s=t.mimeType).startsWith("image/")||s.startsWith("video/")||s.startsWith("audio/")||s.includes("pdf")||s.includes("text"))&&(0,l.jsx)("button",{onClick:g,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Loading...":"Preview"}),(0,l.jsx)("button",{onClick:v,disabled:d,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Loading...":"Download"})]}),(0,l.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"File Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-500",children:"Name:"}),(0,l.jsx)("p",{className:"font-medium",children:t.name})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-500",children:"Size:"}),(0,l.jsx)("p",{className:"font-medium",children:j(t.size)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-500",children:"Type:"}),(0,l.jsx)("p",{className:"font-medium",children:t.mimeType})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-500",children:"ID:"}),(0,l.jsx)("p",{className:"font-medium font-mono text-xs",children:t.id})]})]})]})]})]})})}function f(e){var s,t,r,a;let{currentFolderId:n,onFolderClick:d,onUploadComplete:m}=e,{user:x}=(0,u.a)(),[f,p]=(0,i.useState)(null),{data:v,refetch:g,isLoading:j,error:y}=(0,c.a)({queryKey:["folderContents",n,null==x?void 0:x.id],queryFn:async()=>{if(console.log("FileList: Fetching data for user:",null==x?void 0:x.id,"folder:",n),!x)return console.log("FileList: No user, returning empty data"),{folders:[],files:[]};if(n){console.log("FileList: Fetching folder children for:",n);let{data:e}=await o.h.client.get("/folders/".concat(n,"/children"));return console.log("FileList: Folder children data:",e),{folders:e.folders,files:e.files}}console.log("FileList: Fetching root folder data");let[e,s]=await Promise.all([o.h.client.get("/folders"),o.h.client.get("/files")]);return console.log("FileList: Root data - folders:",e.data.results,"files:",s.data.results),{folders:e.data.results,files:s.data.results.filter(e=>!e.folderId)}}});return(i.useEffect(()=>{m&&m(g)},[m,g]),j)?(0,l.jsx)("div",{className:"text-center py-8",children:(0,l.jsx)("p",{className:"text-gray-500",children:"Loading files..."})}):y?(console.error("FileList error:",y),(0,l.jsx)("div",{className:"text-center py-8",children:(0,l.jsxs)("p",{className:"text-red-500",children:["Error loading files: ",y.message]})})):(console.log("FileList: Rendering with data:",v),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[null==v?void 0:null===(s=v.folders)||void 0===s?void 0:s.map(e=>(0,l.jsxs)("div",{className:"border rounded p-3 bg-white hover:bg-gray-50 cursor-pointer",onClick:()=>null==d?void 0:d(e.id),children:[(0,l.jsx)("div",{className:"font-medium truncate",title:e.name,children:e.name}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"\uD83D\uDCC1 Folder"})]},e.id)),null==v?void 0:null===(t=v.files)||void 0===t?void 0:t.map(e=>{var s,t,r,a,i;return(0,l.jsxs)("div",{className:"border rounded p-3 bg-white hover:bg-gray-50 group cursor-pointer",onDoubleClick:()=>p(e),title:"Double-click to preview",children:[(0,l.jsx)("div",{className:"font-medium truncate",title:e.name,children:e.name}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[(null===(s=e.mimeType)||void 0===s?void 0:s.startsWith("image/"))?"\uD83D\uDDBC️":(null===(t=e.mimeType)||void 0===t?void 0:t.startsWith("video/"))?"\uD83C\uDFA5":(null===(r=e.mimeType)||void 0===r?void 0:r.startsWith("audio/"))?"\uD83C\uDFB5":(null===(a=e.mimeType)||void 0===a?void 0:a.includes("pdf"))?"\uD83D\uDCC4":(null===(i=e.mimeType)||void 0===i?void 0:i.includes("text"))?"\uD83D\uDCDD":"\uD83D\uDCC4",e.mimeType]}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:e.size?"".concat(Math.round(Number(e.size)/1024)," KB"):""}),(0,l.jsxs)("div",{className:"mt-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,l.jsx)("button",{onClick:async s=>{s.stopPropagation();try{console.log("Downloading file:",e.id);let{data:s}=await o.h.client.get("/files/".concat(e.id,"/download"));console.log("Download URL:",s.downloadUrl);let t=document.createElement("a");t.href=s.downloadUrl,t.download=e.name,t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(e){var t,l,r;console.error("Download failed:",e),alert("Download failed: "+((null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(l=r.data)||void 0===l?void 0:null===(t=l.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||"Unknown error"))}},className:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:"Download"}),(0,l.jsx)("button",{onClick:async s=>{if(s.stopPropagation(),confirm("Delete this file?"))try{await o.h.client.delete("/files/".concat(e.id)),g()}catch(e){console.error("Delete failed:",e),alert("Delete failed")}},className:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700",children:"Delete"})]})]},e.id)})]}),(null==v?void 0:null===(r=v.folders)||void 0===r?void 0:r.length)===0&&(null==v?void 0:null===(a=v.files)||void 0===a?void 0:a.length)===0&&(0,l.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,l.jsx)("p",{children:"No files or folders yet"}),(0,l.jsx)("p",{className:"text-sm",children:"Drag and drop files above to upload"})]})]}),f&&(0,l.jsx)(h,{file:f,onClose:()=>p(null)})]}))}var p=t(7648);let v=new r.S;function g(){let{user:e,logout:s}=(0,u.a)();return e?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsxs)(p.default,{href:"/",className:"flex items-center space-x-2",children:[(0,l.jsx)("svg",{className:"h-8 w-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),(0,l.jsx)("span",{className:"text-xl font-bold text-gray-900",children:"CloudDrive"})]})}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)(p.default,{href:"/",className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,l.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Go Home"]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["Welcome, ",(0,l.jsx)("span",{className:"font-medium text-gray-900",children:e.email})]}),(0,l.jsxs)("button",{onClick:s,className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,l.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})]})})}),(0,l.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"File Dashboard"}),(0,l.jsx)("p",{className:"mt-2 text-lg text-gray-600",children:"Upload, manage, and organize your files securely in the cloud."})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Upload Files"}),(0,l.jsx)(d,{onUploadComplete:()=>window.location.reload()})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Your Files"}),(0,l.jsx)("button",{onClick:async()=>{let e=prompt("Folder name:");if(e)try{let{data:s}=await o.h.client.post("/folders",{name:e});console.log("Created folder:",s.folder),window.location.reload()}catch(e){console.error("Failed to create folder:",e),alert("Failed to create folder")}},className:"px-4 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"+ New Folder"})]}),(0,l.jsx)(f,{})]})]})})]}):(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,l.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-6 text-center",children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Required"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Please log in to access your file dashboard."}),(0,l.jsx)(p.default,{href:"/login",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Sign In"})]})})}function j(){return(0,l.jsx)(u.AuthProvider,{children:(0,l.jsx)(a.aH,{client:v,children:(0,l.jsx)(g,{})})})}},4210:function(e,s,t){"use strict";t.d(s,{AuthProvider:function(){return n},a:function(){return o}});var l=t(7437),r=t(2265),a=t(2954);let i=(0,r.createContext)(void 0);function n(e){let{children:s}=e,[t,n]=(0,r.useState)(null),[o,d]=(0,r.useState)(!1);async function c(e,s){d(!0);try{let{data:t}=await a.h.client.post("/auth/login",{email:e,password:s});return a.h.setToken(t.accessToken),n(t.user),sessionStorage.setItem("auth",JSON.stringify({accessToken:t.accessToken,user:t.user})),window.location.href="/dashboard",!0}catch(e){return!1}finally{d(!1)}}async function u(e,s,t){d(!0);try{let{data:l}=await a.h.client.post("/auth/signup",{email:e,password:s,name:t});return a.h.setToken(l.accessToken),n(l.user),sessionStorage.setItem("auth",JSON.stringify({accessToken:l.accessToken,user:l.user})),window.location.href="/dashboard",!0}catch(e){return!1}finally{d(!1)}}return(0,r.useEffect)(()=>{{let e=sessionStorage.getItem("auth");if(e){let s=JSON.parse(e);a.h.setToken(s.accessToken),n(s.user)}}},[]),(0,l.jsx)(i.Provider,{value:{user:t,loading:o,login:c,signup:u,logout:function(){sessionStorage.removeItem("auth"),window.location.href="/",a.h.clearToken(),n(null)}},children:s})}function o(){let e=(0,r.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},2954:function(e,s,t){"use strict";t.d(s,{h:function(){return i}});var l=t(3464);let r=t(9792).env.NEXT_PUBLIC_API_URL||"http://localhost:3000/api";class a{setToken(e){this.client.defaults.headers.common.Authorization="Bearer ".concat(e)}clearToken(){delete this.client.defaults.headers.common.Authorization}constructor(){this.client=l.Z.create({baseURL:r})}}let i=new a}},function(e){e.O(0,[464,648,392,971,117,744],function(){return e(e.s=5133)}),_N_E=e.O()}]);